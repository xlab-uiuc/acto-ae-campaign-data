MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
1.680309992441988e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: CreateOrUpdateStateFul
1.6803099924513614e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() false, patchResult 
Patch: {"spec":{"template":{"spec":{"$setElementOrder/containers":[{"name":"test-cluster-leader"},{"name":"redis-exporter"}],"containers":[{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"$setElementOrder/volumeMounts":[{"mountPath":"/data"},{"mountPath":"/tls"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"test-cluster-leader","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"redis-exporter","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}}}} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzcVU1v2zgQ/S9zpi07ifOhWzfWLgI0qSFnu4ciMMbUuCJKkSw51NYw9N8XlD/iBNk0hz1sepI4fDOceW843AA69Zl8UNZADuhcyNoxCPimTAU5zBmZVlHPiUFAQ4wVMkK+ATTGMrKyJqSlp0qFoXWBPZHGZRiqFJB9JBAv7gZGIylhKPBA6hiYPHQCNC5J90HRuWf7A01Ykd+HXATi6Ba8dinQPoYAb3Uy7MCdAIPN86MeQ6XN4LBPpg87sI48sk2b9m9DvqQVeTKSAuRfnnG2re2lCrN2vCTGRKe0hr3VmjzkiZMDwWXyuz4k/kKeICCqBL04v7y6xJPVgK6uxoMzlJPBJZ6dD07p7IwkVRfL0wl0D52A4EhuRXFaSQyQnwoIpEmmmvINNMiy/vif85yOJt8qSXev8c3UOI1MfSbvtKWOWE7aojLkt81Bpu2/OylnRTm/md8Xd9fForj78NvHYgoCWtSR9sV04oAui+nNfPFhOi2PQH1eeZZpK1HXNnB+fnpxdew2L8rPRbm4/TQtjvweCTgC3v85+1fcgwDV4Ndk+x5xPVQ22xGcbXNoz4cnwwnsYLOo9cxqJdeQw83qzvLMUyCTRoVWLRkKYebtsheafuzZahpMrf8FlhhqEJDF4LOlMllNqLmWNclvw1BD6uQVKh093deeQm11BflEgDKKFeopaVzPSVpTBcjHEwGOvLLVExOrhmzkg23ys2HgCSv1f83cU7DR92NoA1o1ivs/6SLkMB6Nm35IN9YnRcYnl7cKeq/vkcIboJ2A1urY0K2Nhrft3KTfGXINOWT9TX2VwDR/fuk7MKAfznomn4+Ho7fchN2pT53hp1qO3q7li9Cue0h6Rlch05w9Mn1dQ745aHytUTX3u1G80/qdDuPXO/JxUqOUFMKtrfp6oSSs/vKK6VNK9OGZJMdMB7Z+2xPjP57ekyoZf1eawjowNf1pjByTW7d9jPdLwBaVxqWm8vAuj8TRIz3qun8CAAD//1BLBwg/viZI8AIAAJAJAABQSwECFAAUAAgACAAAAAAAP74mSPACAACQCQAACAAAAAAAAAAAAAAAAAAAAAAAb3JpZ2luYWxQSwUGAAAAAAEAAQA2AAAAJgMAAAAA","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":1,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File"}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6803099924741623e+09	INFO	controller_redis	Changes in statefulset Detected, Updating...	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader", "patch": "{\"spec\":{\"template\":{\"spec\":{\"$setElementOrder/containers\":[{\"name\":\"test-cluster-leader\"},{\"name\":\"redis-exporter\"}],\"containers\":[{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"$setElementOrder/volumeMounts\":[{\"mountPath\":\"/data\"},{\"mountPath\":\"/tls\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"test-cluster-leader\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]},{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\",\"value\":\"true\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\",\"value\":\"/tls/tls.key\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"redis-exporter\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]}],\"volumes\":[{\"name\":\"tls-certs\",\"secret\":{\"items\":[{\"path\":\"ACTOKEY\"}]}}]}}}}"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{}}]},"status":{"availableReplicas":0,"replicas":0}}

MATT IS HERE: updateStatefulSet &v1.StatefulSet{TypeMeta:v1.TypeMeta{Kind:"StatefulSet", APIVersion:"apps/v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-leader", GenerateName:"", Namespace:"redis-operator", SelfLink:"", UID:"", ResourceVersion:"1389", Generation:0, CreationTimestamp:time.Date(2023, time.April, 1, 0, 44, 12, 0, time.Local), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-leader", "redis_setup_type":"cluster", "role":"leader"}, Annotations:map[string]string{"banzaicloud.com/last-applied":"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", "redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference{v1.OwnerReference{APIVersion:"redis.redis.opstreelabs.in/v1beta1", Kind:"RedisCluster", Name:"test-cluster", UID:"76898a2f-e991-4ac5-8a46-3e44eced7b35", Controller:(*bool)(0xc000bac998), BlockOwnerDeletion:(*bool)(nil)}}, Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry{v1.ManagedFieldsEntry{Manager:"Go-http-client", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.April, 1, 0, 44, 12, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000b15278), Subresource:""}, v1.ManagedFieldsEntry{Manager:"kube-controller-manager", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.April, 1, 0, 44, 48, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000b152a8), Subresource:"status"}}}, Spec:v1.StatefulSetSpec{Replicas:(*int32)(0xc000bac994), Selector:(*v1.LabelSelector)(0xc00043d740), Template:v1.PodTemplateSpec{ObjectMeta:v1.ObjectMeta{Name:"", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-leader", "redis_setup_type":"cluster", "role":"leader"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PodSpec{Volumes:[]v1.Volume{v1.Volume{Name:"tls-certs", VolumeSource:v1.VolumeSource{HostPath:(*v1.HostPathVolumeSource)(nil), EmptyDir:(*v1.EmptyDirVolumeSource)(nil), GCEPersistentDisk:(*v1.GCEPersistentDiskVolumeSource)(nil), AWSElasticBlockStore:(*v1.AWSElasticBlockStoreVolumeSource)(nil), GitRepo:(*v1.GitRepoVolumeSource)(nil), Secret:(*v1.SecretVolumeSource)(0xc0002507a0), NFS:(*v1.NFSVolumeSource)(nil), ISCSI:(*v1.ISCSIVolumeSource)(nil), Glusterfs:(*v1.GlusterfsVolumeSource)(nil), PersistentVolumeClaim:(*v1.PersistentVolumeClaimVolumeSource)(nil), RBD:(*v1.RBDVolumeSource)(nil), FlexVolume:(*v1.FlexVolumeSource)(nil), Cinder:(*v1.CinderVolumeSource)(nil), CephFS:(*v1.CephFSVolumeSource)(nil), Flocker:(*v1.FlockerVolumeSource)(nil), DownwardAPI:(*v1.DownwardAPIVolumeSource)(nil), FC:(*v1.FCVolumeSource)(nil), AzureFile:(*v1.AzureFileVolumeSource)(nil), ConfigMap:(*v1.ConfigMapVolumeSource)(nil), VsphereVolume:(*v1.VsphereVirtualDiskVolumeSource)(nil), Quobyte:(*v1.QuobyteVolumeSource)(nil), AzureDisk:(*v1.AzureDiskVolumeSource)(nil), PhotonPersistentDisk:(*v1.PhotonPersistentDiskVolumeSource)(nil), Projected:(*v1.ProjectedVolumeSource)(nil), PortworxVolume:(*v1.PortworxVolumeSource)(nil), ScaleIO:(*v1.ScaleIOVolumeSource)(nil), StorageOS:(*v1.StorageOSVolumeSource)(nil), CSI:(*v1.CSIVolumeSource)(nil), Ephemeral:(*v1.EphemeralVolumeSource)(nil)}}}, InitContainers:[]v1.Container(nil), Containers:[]v1.Container{v1.Container{Name:"test-cluster-leader", Image:"quay.io/opstree/redis:v6.2.5", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"test-cluster-leader", ReadOnly:false, MountPath:"/data", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}, v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(0xc0006a3c40), ReadinessProbe:(*v1.Probe)(0xc0006a3c00), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}, v1.Container{Name:"redis-exporter", Image:"quay.io/opstree/redis-exporter:1.0", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_SKIP_TLS_VERIFICATION", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CA_CERT_FILE", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(nil), ReadinessProbe:(*v1.Probe)(nil), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}}, EphemeralContainers:[]v1.EphemeralContainer(nil), RestartPolicy:"", TerminationGracePeriodSeconds:(*int64)(nil), ActiveDeadlineSeconds:(*int64)(nil), DNSPolicy:"", NodeSelector:map[string]string(nil), ServiceAccountName:"", DeprecatedServiceAccount:"", AutomountServiceAccountToken:(*bool)(nil), NodeName:"", HostNetwork:false, HostPID:false, HostIPC:false, ShareProcessNamespace:(*bool)(nil), SecurityContext:(*v1.PodSecurityContext)(nil), ImagePullSecrets:[]v1.LocalObjectReference(nil), Hostname:"", Subdomain:"", Affinity:(*v1.Affinity)(nil), SchedulerName:"", Tolerations:[]v1.Toleration(nil), HostAliases:[]v1.HostAlias(nil), PriorityClassName:"", Priority:(*int32)(nil), DNSConfig:(*v1.PodDNSConfig)(nil), ReadinessGates:[]v1.PodReadinessGate(nil), RuntimeClassName:(*string)(nil), EnableServiceLinks:(*bool)(nil), PreemptionPolicy:(*v1.PreemptionPolicy)(nil), Overhead:v1.ResourceList(nil), TopologySpreadConstraints:[]v1.TopologySpreadConstraint(nil), SetHostnameAsFQDN:(*bool)(nil), OS:(*v1.PodOS)(nil)}}, VolumeClaimTemplates:[]v1.PersistentVolumeClaim{v1.PersistentVolumeClaim{TypeMeta:v1.TypeMeta{Kind:"PersistentVolumeClaim", APIVersion:"v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-leader", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-leader", "redis_setup_type":"cluster", "role":"leader"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PersistentVolumeClaimSpec{AccessModes:[]v1.PersistentVolumeAccessMode{"ReadWriteOnce"}, Selector:(*v1.LabelSelector)(nil), Resources:v1.ResourceRequirements{Limits:v1.ResourceList(nil), Requests:v1.ResourceList{"storage":resource.Quantity{i:resource.int64Amount{value:1073741824, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"1Gi", Format:"BinarySI"}}}, VolumeName:"", StorageClassName:(*string)(nil), VolumeMode:(*v1.PersistentVolumeMode)(0xc0009833c0), DataSource:(*v1.TypedLocalObjectReference)(nil), DataSourceRef:(*v1.TypedLocalObjectReference)(nil)}, Status:v1.PersistentVolumeClaimStatus{Phase:"Pending", AccessModes:[]v1.PersistentVolumeAccessMode(nil), Capacity:v1.ResourceList(nil), Conditions:[]v1.PersistentVolumeClaimCondition(nil), AllocatedResources:v1.ResourceList(nil), ResizeStatus:(*v1.PersistentVolumeClaimResizeStatus)(nil)}}}, ServiceName:"test-cluster-leader", PodManagementPolicy:"", UpdateStrategy:v1.StatefulSetUpdateStrategy{Type:"", RollingUpdate:(*v1.RollingUpdateStatefulSetStrategy)(nil)}, RevisionHistoryLimit:(*int32)(nil), MinReadySeconds:0, PersistentVolumeClaimRetentionPolicy:(*v1.StatefulSetPersistentVolumeClaimRetentionPolicy)(nil)}, Status:v1.StatefulSetStatus{ObservedGeneration:0, Replicas:0, ReadyReplicas:0, CurrentReplicas:0, UpdatedReplicas:0, CurrentRevision:"", UpdateRevision:"", CollisionCount:(*int32)(nil), Conditions:[]v1.StatefulSetCondition(nil), AvailableReplicas:0}}
1.6803099927823772e+09	INFO	controller_redis	Redis stateful successfully updated 	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.680309992785404e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803099928706465e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803099928757842e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803099928792238e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680309992882987e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803099928830047e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803099929711785e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() false, patchResult 
Patch: {"spec":{"template":{"spec":{"$setElementOrder/containers":[{"name":"test-cluster-follower"},{"name":"redis-exporter"}],"containers":[{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"$setElementOrder/volumeMounts":[{"mountPath":"/data"},{"mountPath":"/tls"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"test-cluster-follower","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"redis-exporter","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}}}} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzcVd9v2zgM/l/4rMR12/SH33aN71Bg7QKnt3sYioCRmVmYLGkS5S0I/L8f5PxYWvSufTngtqfE1EeK/D6S2gA69ZF8UNZAAehcyLocBHxRpoYC5oxMq6jnxCCgJcYaGaHYABpjGVlZE9Knp1qFsXWBPZHGZRirFJB9JBAvngZGIylhKPBI6hiYPPQCNC5JD0HRuWfno5XV2n4jvw+6CMTRLXjtUqh9FAHe6mQ4wHsBBtvn1x2HS8fB4ZDSEHpkHXlkmw7tN0O+ohV5MpICFJ+eMbet8KU6sy5fEmMiVVrD3mpNHorEzIHmKvndHJJ/IVMQEFWCXl5cXV/h6WpE19f56BzlZHSF5xejMzo/J0n15fJsAv1jLyA4kltpnFYSAxRnAgJpkqmmYgMtsmze/ydsp+vJd0rS/b+zztQ6jUxDPj9xex3xnVRGZchv24RMN/zuRJ2V1fx2/lDe35SL8v7db+/LKQjoUEfaF9SLA7oqp7fzxbvptDoCDZkVWaatRN3YwMXF2eX1sdu8rD6W1eLuw7Q88vtBwhHw4c/ZP+IeBagWPyfb14jrsbLZjuRsm0N3MT4dT2AHm0WtZ1YruYYCblf3lmeeApm0OrTqyFAIM2+Xg9j0fc9W22Iagk+wxNCAgCwGny2VyRpCzY1sSH4ZhwZST69Q6ejpofEUGqtrKCYClFGsUE9J43pO0po6QJFPBDjyytZPTKxaspEPtsnri8ET1ur/mrunYKMfVtIGtGoVD/+ki1BAfpK3w9purU+a5KdXdwoGr6+RwhugvYDO6tjSnY2Gtw3dpr8z5AYKyIZ5fYXCtI1+6TkY0XdnPZMv8vHJW6Zhd+tTZ3hVzZO3q/kitO8fk6LR1cg0Z49Mn9dQbA4q32hU7cNuJe/U/omX8mt9+WNno5QUwp2th6qhIqz/8orpQ0r38Zkwx3wHtn7bGfkfT+elTsbflaawDkztcBsjx+TWbx/o/Sdgh0rjUlN1eKtPxNHDfdL3fwcAAP//UEsHCM2zt+vyAgAAqgkAAFBLAQIUABQACAAIAAAAAADNs7fr8gIAAKoJAAAIAAAAAAAAAAAAAAAAAAAAAABvcmlnaW5hbFBLBQYAAAAAAQABADYAAAAoAwAAAAA=","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":1,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File"}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6803099933761344e+09	INFO	controller_redis	Changes in statefulset Detected, Updating...	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower", "patch": "{\"spec\":{\"template\":{\"spec\":{\"$setElementOrder/containers\":[{\"name\":\"test-cluster-follower\"},{\"name\":\"redis-exporter\"}],\"containers\":[{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"$setElementOrder/volumeMounts\":[{\"mountPath\":\"/data\"},{\"mountPath\":\"/tls\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"test-cluster-follower\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]},{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\",\"value\":\"true\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\",\"value\":\"/tls/tls.key\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"redis-exporter\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]}],\"volumes\":[{\"name\":\"tls-certs\",\"secret\":{\"items\":[{\"path\":\"ACTOKEY\"}]}}]}}}}"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{}}]},"status":{"availableReplicas":0,"replicas":0}}

MATT IS HERE: updateStatefulSet &v1.StatefulSet{TypeMeta:v1.TypeMeta{Kind:"StatefulSet", APIVersion:"apps/v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-follower", GenerateName:"", Namespace:"redis-operator", SelfLink:"", UID:"", ResourceVersion:"1382", Generation:0, CreationTimestamp:time.Date(2023, time.April, 1, 0, 44, 13, 0, time.Local), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-follower", "redis_setup_type":"cluster", "role":"follower"}, Annotations:map[string]string{"banzaicloud.com/last-applied":"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", "redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference{v1.OwnerReference{APIVersion:"redis.redis.opstreelabs.in/v1beta1", Kind:"RedisCluster", Name:"test-cluster", UID:"76898a2f-e991-4ac5-8a46-3e44eced7b35", Controller:(*bool)(0xc000a10a04), BlockOwnerDeletion:(*bool)(nil)}}, Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry{v1.ManagedFieldsEntry{Manager:"Go-http-client", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.April, 1, 0, 44, 13, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000b148a0), Subresource:""}, v1.ManagedFieldsEntry{Manager:"kube-controller-manager", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.April, 1, 0, 44, 47, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000b148d0), Subresource:"status"}}}, Spec:v1.StatefulSetSpec{Replicas:(*int32)(0xc000a10a00), Selector:(*v1.LabelSelector)(0xc00003a420), Template:v1.PodTemplateSpec{ObjectMeta:v1.ObjectMeta{Name:"", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-follower", "redis_setup_type":"cluster", "role":"follower"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PodSpec{Volumes:[]v1.Volume{v1.Volume{Name:"tls-certs", VolumeSource:v1.VolumeSource{HostPath:(*v1.HostPathVolumeSource)(nil), EmptyDir:(*v1.EmptyDirVolumeSource)(nil), GCEPersistentDisk:(*v1.GCEPersistentDiskVolumeSource)(nil), AWSElasticBlockStore:(*v1.AWSElasticBlockStoreVolumeSource)(nil), GitRepo:(*v1.GitRepoVolumeSource)(nil), Secret:(*v1.SecretVolumeSource)(0xc0002507a0), NFS:(*v1.NFSVolumeSource)(nil), ISCSI:(*v1.ISCSIVolumeSource)(nil), Glusterfs:(*v1.GlusterfsVolumeSource)(nil), PersistentVolumeClaim:(*v1.PersistentVolumeClaimVolumeSource)(nil), RBD:(*v1.RBDVolumeSource)(nil), FlexVolume:(*v1.FlexVolumeSource)(nil), Cinder:(*v1.CinderVolumeSource)(nil), CephFS:(*v1.CephFSVolumeSource)(nil), Flocker:(*v1.FlockerVolumeSource)(nil), DownwardAPI:(*v1.DownwardAPIVolumeSource)(nil), FC:(*v1.FCVolumeSource)(nil), AzureFile:(*v1.AzureFileVolumeSource)(nil), ConfigMap:(*v1.ConfigMapVolumeSource)(nil), VsphereVolume:(*v1.VsphereVirtualDiskVolumeSource)(nil), Quobyte:(*v1.QuobyteVolumeSource)(nil), AzureDisk:(*v1.AzureDiskVolumeSource)(nil), PhotonPersistentDisk:(*v1.PhotonPersistentDiskVolumeSource)(nil), Projected:(*v1.ProjectedVolumeSource)(nil), PortworxVolume:(*v1.PortworxVolumeSource)(nil), ScaleIO:(*v1.ScaleIOVolumeSource)(nil), StorageOS:(*v1.StorageOSVolumeSource)(nil), CSI:(*v1.CSIVolumeSource)(nil), Ephemeral:(*v1.EphemeralVolumeSource)(nil)}}}, InitContainers:[]v1.Container(nil), Containers:[]v1.Container{v1.Container{Name:"test-cluster-follower", Image:"quay.io/opstree/redis:v6.2.5", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"test-cluster-follower", ReadOnly:false, MountPath:"/data", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}, v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(0xc000a4d740), ReadinessProbe:(*v1.Probe)(0xc000a4d700), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}, v1.Container{Name:"redis-exporter", Image:"quay.io/opstree/redis-exporter:1.0", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_SKIP_TLS_VERIFICATION", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CA_CERT_FILE", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(nil), ReadinessProbe:(*v1.Probe)(nil), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}}, EphemeralContainers:[]v1.EphemeralContainer(nil), RestartPolicy:"", TerminationGracePeriodSeconds:(*int64)(nil), ActiveDeadlineSeconds:(*int64)(nil), DNSPolicy:"", NodeSelector:map[string]string(nil), ServiceAccountName:"", DeprecatedServiceAccount:"", AutomountServiceAccountToken:(*bool)(nil), NodeName:"", HostNetwork:false, HostPID:false, HostIPC:false, ShareProcessNamespace:(*bool)(nil), SecurityContext:(*v1.PodSecurityContext)(nil), ImagePullSecrets:[]v1.LocalObjectReference(nil), Hostname:"", Subdomain:"", Affinity:(*v1.Affinity)(nil), SchedulerName:"", Tolerations:[]v1.Toleration(nil), HostAliases:[]v1.HostAlias(nil), PriorityClassName:"", Priority:(*int32)(nil), DNSConfig:(*v1.PodDNSConfig)(nil), ReadinessGates:[]v1.PodReadinessGate(nil), RuntimeClassName:(*string)(nil), EnableServiceLinks:(*bool)(nil), PreemptionPolicy:(*v1.PreemptionPolicy)(nil), Overhead:v1.ResourceList(nil), TopologySpreadConstraints:[]v1.TopologySpreadConstraint(nil), SetHostnameAsFQDN:(*bool)(nil), OS:(*v1.PodOS)(nil)}}, VolumeClaimTemplates:[]v1.PersistentVolumeClaim{v1.PersistentVolumeClaim{TypeMeta:v1.TypeMeta{Kind:"PersistentVolumeClaim", APIVersion:"v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-follower", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-follower", "redis_setup_type":"cluster", "role":"follower"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PersistentVolumeClaimSpec{AccessModes:[]v1.PersistentVolumeAccessMode{"ReadWriteOnce"}, Selector:(*v1.LabelSelector)(nil), Resources:v1.ResourceRequirements{Limits:v1.ResourceList(nil), Requests:v1.ResourceList{"storage":resource.Quantity{i:resource.int64Amount{value:1073741824, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"1Gi", Format:"BinarySI"}}}, VolumeName:"", StorageClassName:(*string)(nil), VolumeMode:(*v1.PersistentVolumeMode)(0xc000625a60), DataSource:(*v1.TypedLocalObjectReference)(nil), DataSourceRef:(*v1.TypedLocalObjectReference)(nil)}, Status:v1.PersistentVolumeClaimStatus{Phase:"Pending", AccessModes:[]v1.PersistentVolumeAccessMode(nil), Capacity:v1.ResourceList(nil), Conditions:[]v1.PersistentVolumeClaimCondition(nil), AllocatedResources:v1.ResourceList(nil), ResizeStatus:(*v1.PersistentVolumeClaimResizeStatus)(nil)}}}, ServiceName:"test-cluster-follower", PodManagementPolicy:"", UpdateStrategy:v1.StatefulSetUpdateStrategy{Type:"", RollingUpdate:(*v1.RollingUpdateStatefulSetStrategy)(nil)}, RevisionHistoryLimit:(*int32)(nil), MinReadySeconds:0, PersistentVolumeClaimRetentionPolicy:(*v1.StatefulSetPersistentVolumeClaimRetentionPolicy)(nil)}, Status:v1.StatefulSetStatus{ObservedGeneration:0, Replicas:0, ReadyReplicas:0, CurrentReplicas:0, UpdatedReplicas:0, CurrentRevision:"", UpdateRevision:"", CollisionCount:(*int32)(nil), Conditions:[]v1.StatefulSetCondition(nil), AvailableReplicas:0}}
1.680309993482311e+09	INFO	controller_redis	Redis stateful successfully updated 	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803099935752213e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680309993577866e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680309993581661e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680309993671705e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680309993676985e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803099936770198e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803099936820884e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803099937748067e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803099937748432e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.680309993780358e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.6803099937807758e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680309993780834e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680309993780851e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.680309998781238e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680309998781366e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803099987819657e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6803099987824132e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0"}
1.6803099987963667e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.680309998797305e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803099987974346e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803099987974777e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.680310003798339e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100037984517e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100037984793e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6803100037984972e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0", "Type": "leader"}
1.6803100037985063e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 0, "Instance.Size": 3}
1.680310003803746e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.6803100038081493e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.6803100038121734e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "10.244.1.9"}
1.6803100038122165e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "10.244.1.9:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"]}
1.6803100038165967e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.6803100039316347e+09	ERROR	controller_redis	Could not execute command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "10.244.1.9:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": "", "Error": "Unrecognized option or bad number of args for: '--tls'\n", "error": "command terminated with exit code 1"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:71
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100039317641e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "10.244.1.9:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": ""}
1.6803100039317982e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
1.6803100039318843e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
MATT IS HERE: patchStatefulSet
1.6803100039705405e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1482","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6803100042740843e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1482"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803100043759682e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100043782384e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100043814147e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100044713998e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100044757614e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803100044757965e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803100044802094e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1496","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1496"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803100047703545e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803100049783373e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680310005072569e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680310005170145e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100051741326e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100051792374e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100051792674e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100051843092e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803100051900716e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803100051901104e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.6803100052761729e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.6803100052770646e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100052771664e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100052772148e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.680310010278197e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100102783332e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100102783713e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6803100102783961e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0"}
1.6803100102881193e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.6803100102889082e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680310010288982e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100102890172e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6803100152898202e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100152898724e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680310015289884e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6803100152898996e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0", "Type": "leader"}
1.680310015289905e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 0, "Instance.Size": 3}
1.680310015298404e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.6803100153040888e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.6803100153079157e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "10.244.1.9"}
1.6803100153079567e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "10.244.1.9:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"]}
1.6803100153121047e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.6803100155705965e+09	ERROR	controller_redis	Could not execute command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "10.244.1.9:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": "", "Error": "Unrecognized option or bad number of args for: '--tls'\n", "error": "command terminated with exit code 1"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:71
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100155709198e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "10.244.1.9:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": ""}
1.6803100155709357e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
1.6803100155710602e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803100155768943e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803100156771896e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1482","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1482"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680310015680769e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100156820843e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100157704532e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100157738893e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
1.6803100158720264e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.680310015872077e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803100161708493e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803100163730593e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1496","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1496"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803100163805997e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803100164702923e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803100164750988e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100167705686e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100167770677e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100167771158e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100167820437e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803100168763041e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803100168763742e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.6803100168817732e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.68031001688263e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100169696932e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100169697409e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6803100219709854e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680310021971122e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100219711583e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.680310021971179e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0"}
1.6803100219829342e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.680310021983479e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680310021983532e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100219835522e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6803100269842668e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680310026984376e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100269844081e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6803100269844263e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0", "Type": "leader"}
1.680310026984436e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 0, "Instance.Size": 3}
1.6803100269932575e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.5"}
1.6803100269984381e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.6803100270019832e+09	ERROR	controller_redis	Error in getting redis pod IP	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "error": "pods \"test-cluster-leader-2\" not found"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:57
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100270020828e+09	INFO	controller_redis	Redis is IPv6	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "", "ipv6": "<nil>"}
1.6803100270020993e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "[]"}
1.6803100270021088e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "[]:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"]}
1.68031002700701e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.6803100273007731e+09	ERROR	controller_redis	Could not execute command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "[]:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": "", "Error": "Unrecognized option or bad number of args for: '--tls'\n", "error": "command terminated with exit code 1"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:71
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6803100273009307e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.5:6379", "10.244.2.6:6379", "[]:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": ""}
1.6803100273009462e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
1.6803100273010206e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803100273715994e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6803100275734353e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803100275791574e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100275818062e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100276702132e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100276741917e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100276788366e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803100276788938e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803100276836495e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6803100282754726e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680310028284422e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803100283703575e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680310028373889e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100286711068e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100286772912e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100286773534e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100287711782e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.680310028870417e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803100288704967e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680310037302047e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6803100373130705e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6803100373774607e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803100375742407e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.680310037577646e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803100376699395e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100376721606e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803100376759987e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.680310037676035e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680310037680786e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803100378744648e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803100378825157e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803100382728617e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.68031003828128e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100383717623e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803100383774326e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.680310038377503e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803100383814886e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803100384702778e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.680310038470312e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6803101584712722e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680310158480611e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803101589740956e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803101590777793e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803101590809722e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803101590847769e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.680310159090497e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803101594698787e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803101594699388e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803101595761569e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803101596715796e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803101596766849e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680310159770374e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680310159775406e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803101597777562e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803101597836406e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803101597837086e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803101598718908e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803101599716012e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803101599716735e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6803102799725688e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803102799784575e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803102803705804e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803102803769286e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.680310280379097e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803102804697347e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803102804723074e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803102804768496e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803102804768836e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803102804820757e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803102809781947e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803102809828875e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803102809852958e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680310281069973e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803102810720696e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803102810754476e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803102810754743e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803102810786161e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.680310281176503e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803102811765516e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6803104011774576e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803104011879265e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.680310401570506e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803104015755594e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803104015767412e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803104015802677e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803104015817401e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803104015846806e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803104015847318e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680310401671188e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.680310402074127e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803104021763234e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803104021784296e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803104021823602e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680310402270001e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680310402274075e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803104022741053e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.680310402278084e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803104022816632e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803104022816997e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6803105222821171e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803105222954974e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzsWFtvIjkW/i/nuYpLQtJJvWVJdRZ1LgiY7M4kETKuQ7DismtsF9ss4r+v7LpSQIfpbXVPSy3lIdjnYn/n4u/UGkjCHlFpJgUEQJJEt5dd8OCNiQgCGBticJ7yMRrwIEZDImIIBGsgQkhDDJNC258KI6ZbMtFGIXIy0y1mDRqVInh7d7UhgqKVQW18ylNtUMHGA6rQ2Z2wGLUhcQIBnHROTv1Oz+90J51O0OsF3ZM/wANOZsidf5IkDVM+RxKhKrxPNZo0mZpVYn0W7jxQktuFXHjjQUwEecXoI0MeaQieDkI0dxKTzGAm/litP3btseZBHbN50ECtBcF648E8mBHxX8Iol2nUojJuc6KNT5KEM4wKmf0QH94rAF5vnEiFVenVgVYzsIVRvu7gyU3I/whUI5yjQkGxbustWD9DyqJnCJ7hw/nF5QU5mft4edn1e4Se+Rekd+6fYq+HFKMPs9OzZ9g4s86uTpBm+CQyunP4xyjMUHJGV9UJE84o0dXvJbMx+SfTRqrVLYuZKfY0cqRGquq3WjKK9yQuL2YwTjgx+Fei9GMj0ICKSmEIE6icRRcAQWJ0EXC2fPycSGVQZVhXTlEsm6ErNYfhaDwYT8L7fjgN76/+cRteN9VFDcUl4WlxwW1Do/B6MJ5eXV+Pvk5/HI4ew9H07uE6/FoDk9+Gf0Hf/WQxeS333I9hyvl2ItbVFWqZqu1amAfc5uL2Ek3S4t8YY6lWZVYo/DNFfZR4nrgqZsJl5x1qbY9IzKJK653d8vA7EO1pl79y5Rj9o3OFsyUK1Hqo5Ay3gf2cFXIVchnHRERlXswJ46nCyUKhXkhePgNMMMMIv0ZOVmOkUkRlS0xQMRk1FnVKKWq9Y8ewGGVqatJ7sptE7Oc6/k9VkC6pJE9jvJOpMDsPamxXrTGXpG37QDXzsxSBRsJu8tNFQjffUW2Iajyumi4wSjmq+hOpkaaKmVVfCoOfzZ4b3ShCcdgMW+Y4TSJicGwUMfi6yt4sJTln4vU3t7V1j4Qow4yjWHkYijewhlKfExZP8oe7dJURNgUB3Eh/YUziU85QWMIqE1Qkswq5Uw9s5hyilBvv/6R72hCT6pxGLAnjZMZx1KAu1MJgHfRt9MrVVCkUZke4WM7oTrEsZ5bUYHSDorxjVbWrppUme8qi0zSarUZ15W2E39IZ+pZ52Eii8oudA1DrdFYUJASQY3M4Ar2LP2Dz4kGWwwfYvN3UCXEWM56TuZbuFE2G2qTvGU3bR9bay+4MDbEhrS4IgZ1gynFoZPX65eyw55zgWRoMwVEk2F22AKg6Y/f04tJOIgXXq2J36kGN2kJMDF3cfvMZyLquE+YDJusM+vtMht9+3KuhXOfTT2twxOdpXcR4D9cBD3JGkF3G9o5cuiI0NSF3Lh2021xSwhdSm+D89MPlrt7kdjztX00/hb/XtNuG6zYlLarMAY1wNGnKG66/rLDPiVV6w1VdqUawatJVZGqCBZH6spz135DKMHzxIOdV8GdKVi0m23lytB1+wfK8ddI6g1yszrhgML+XZqhQZ81/h3sVnKWkKk8wI3oBHrRTrdozJtoLJNws6ALpW0sv4MV2xR0ic+bBXhbTPfOgwWHsUpOpnG3e6XC7tOtvdPItglXxKsePoNvpxu47UcaQoHtyccfAaVWc6ouiGw+2GdHTGmocJyNB+1uvX37DaagYrmsaXPsUldE50A+Cr7Iuv3mxmj+w7sN/Dx9Gk3A0HX8aDF2JPoajwcdB/2oyeLh/122pnvcPV98fB7fhsV1k28DtILyfHDZysLXss/Ip/P2gkUar+dUC32uB5XedoNvqHNMIc4fbyvBuKXeOL+W9ou+W8vF1+VKY0vXarKtopAotlQZmMM7EkszPVX/yYGO8ednYPw92JpPypM0Bo8ke65/Gh3ZVGxTmsdL9bh/Jvz0VeqenljyJuHn8TkYOIBghif6lmMEHe9CXRlbVk0UbqbK07t5sp0eEbqTiqFfaYOy8lXNUsiAaHd4iYuIVbBDr+3umrI5X48ydzeZ/AQAA//9QSwcIBz+EA/oFAADmGAAAUEsBAhQAFAAIAAgAAAAAAAc/hAP6BQAA5hgAAAgAAAAAAAAAAAAAAAAAAAAAAG9yaWdpbmFsUEsFBgAAAAABAAEANgAAADAGAAAAAA==","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579","uid":"0c89be9c-f8a3-4c1c-bc9d-5ad916228b98"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:32Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:32Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1579"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:12Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:12Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:48Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1389"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6803105226724513e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803105226792898e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803105226808486e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6803105226837692e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803105226854248e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6803105226879284e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6803105226879642e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6803105227705314e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6803105233700821e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599","uid":"03c348d1-9e34-4c8a-8d54-95ccbae31e15"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:46:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:46:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1599"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-04-01T00:44:13Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"76898a2f-e991-4ac5-8a46-3e44eced7b35\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-04-01T00:44:13Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-04-01T00:44:47Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"76898a2f-e991-4ac5-8a46-3e44eced7b35"}],"resourceVersion":"1382"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"path":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.68031052337424e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803105233771858e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6803105233799944e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803105233816988e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6803105233850179e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803105233850636e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6803105234710214e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6803105235711148e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6803105235711687e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}

