MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989482822604e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
1.6802989483700426e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzcVU1v4zYQ/S9zli3LrvOh2zZWiwCbrCGn28MiMEbUZEUsRXLJobqGof9eUP6IE6TZHHpoepI4fDOceW843AJa+Zmcl0ZDDmitT7sMEvgmdQ05rBiZHoJaEUMCLTHWyAj5FlBrw8jSaB+Xjmrpx8Z6dkQKKz+WMSC7QJC8uOsZtaCIIc8joYJnctAnoLAiNQRFa5/tjxRhTe4Qcu2Jg13zxsZAhxgJOKOiYQ/uE9DYPj/qMVTc9BaHZIawI2PJIZu4af7S5Ep6IEdakIf8yzPOdrW9VGHaZRUxRjqF0eyMUuQgj5wcCS6j39Ux8RfyhASCjNDzWXUxFdVkJCbT+eiX84vJ6LKe1aNsNqXsUtRnVF1Af98n4C2JnShWSYEe8lkCnhSJWFO+hRZZNB//dZ7j0eQ6Kej2Nb6ZWquQacjknbbUCctRW5Sa3K45SHfDdy/lsihX16u74vaqWBe3H379WCwggQ5VoEMxfXJEl8XierX+sFiUJ6AhrzxNlRGoGuM5P5udX566rYryc1Gubz4tihO/RwJOgHd/LP8Rd5+AbPFrtH0PuBlLk+4JTnc5dGfj6XgOe9gyKLU0SooN5HD9cGt46ciTjqNCyY40eb90phqEph8HttoWY+t/gQp9Awmkwbu0kjptCBU3oiHxbewbiJ38gFIFR3eNI98YVUM+T0BqyRLVghRuViSMrj3k2TwBS06a+omJZUsm8NE2/9kwcIS1/K9m7sib4IYxtAUlW8nDn7ABcsgmWTsM6da4qEg2vbiRMHh9D+TfAO0T6IwKLd2YoHnXzm38XSI3kEM63NRXCYzz5399B0b0wxrH5PJsPHnLTdif+tQZfqrl5O1avgjt+/uoZ7A1Mq3YIdPXDeTbo8ZXCmV7tx/Fe63f6TB+vSMfJzUKQd7fmHqoF0rC+k8nmT7FRO+fSXLKtGfjdj2R/f70ntTR+JtU5DeeqR1OY+QQ3frdY3xYAnYoFVaKyuO7PElOHulJ3/8dAAD//1BLBwjY2PSV8AIAAJAJAABQSwECFAAUAAgACAAAAAAA2Nj0lfACAACQCQAACAAAAAAAAAAAAAAAAAAAAAAAb3JpZ2luYWxQSwUGAAAAAAEAAQA2AAAAJgMAAAAA","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":1,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File"}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{}}]},"status":{"availableReplicas":0,"replicas":0}}

1.68029894837671e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989485723863e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989485786688e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.680298948580535e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989485840144e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.68029894858406e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989486708581e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzcVd9v2zYQ/l/uWbYse84PvXWxNgRoUkPOuociME7UuSJKkSx5VGsY+t8Hyj/qBNmSlwHrnmwdvzvefd/dcQdo5UdyXhoNOaC1Pu0ySOCL1DXksGJk2gS1IoYEWmKskRHyHaDWhpGl0T5+OqqlHxvr2REprPxYxoDsAkHy4qln1IIihjyPhAqeyUGfgMKK1BAUrX12PtoYpcw3csega08c7Jq3NoY6RknAGRUNJ3ifgMb2+XXn4eKxtzikNIQeGUsO2cRD802TK2lDjrQgD/mnZ8ztK3ypzrTLKmKMpAqj2RmlyEEemTnRXEa/m1PyL2QKCQQZoZez6moqqslITKbz0S+XV5PRdT2rR9lsStm1qC+ouoL+sU/AWxJ7aaySAj3kswQ8KRKxpnwHLbJo3v8rbMfryXVS0P0/s87UWoVMQz4/cXud8R1VRqnJ7duEdDf8HkRdFuXqdvVQ3N8U6+L+3a/viwUk0KEKdCyoT07osljcrtbvFovyDDRklqepMgJVYzznF7PL63O3VVF+LMr13YdFceb3g4Qz4MMfy7/FPSYgW/wcbV8DbsfSpAeS030O3cV4Op7DAbYMSi2NkmILOdxu7g0vHXnScXUo2ZEm75fOVIPY9P3IVttiHIJPUKFvIIE0eJdWUqcNoeJGNCS+jH0Dsac3KFVw9NA48o1RNeTzBKSWLFEtSOF2RcLo2kOezROw5KSpn5hYtmQCn2zz1xeDI6zlfzV3R94EN6ykHSjZSh7+CRsgh2yStcPabo2LmmTTqzsJg9fXQP4N0D6BzqjQ0p0JmvcN3ca/S+QGckiHeX2FwriN/tdzMKLv1jgml2fjyVum4XDrU2d4Vc3J29V8Edr3j1HRYGtkWrFDps9byHcnlW8UyvbhsJIPav/ES/m1vvyxs1EI8v7O1EPVUBLWfzrJ9CGm+/hMmHO+PRu374zs96fzUkfjb1KR33qmdriNkUN06/cP9PETsEOpsFJUnt7qSXL2cE/6/q8AAAD//1BLBwhJAeJl8wIAAKoJAABQSwECFAAUAAgACAAAAAAASQHiZfMCAACqCQAACAAAAAAAAAAAAAAAAAAAAAAAb3JpZ2luYWxQSwUGAAAAAAEAAQA2AAAAKQMAAAAA","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":1,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File"}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.680298948777101e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{}}]},"status":{"availableReplicas":0,"replicas":0}}

1.68029894878119e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989487826192e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989488765368e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989492709541e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680298949275062e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.68029894927512e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989492798917e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.680298949283839e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802989492838812e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.6802989492892306e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989493697283e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": "bff5f448ab2fd11183a3e946e0b5bfec898ba0ba 10.244.3.4:6379@16379 myself,master - 0 0 0 connected\n"}
1.6802989493698e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "1"}
1.6802989493759737e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989494695992e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": "bff5f448ab2fd11183a3e946e0b5bfec898ba0ba 10.244.3.4:6379@16379 myself,master - 0 0 0 connected\n"}
1.6802989494696958e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "1", "Type": "leader"}
1.6802989494697256e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 1, "Instance.Size": 3}
1.680298949476361e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989494805682e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.680298949484396e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "10.244.1.4"}
1.6802989494844482e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes"]}
1.6802989495711684e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.6802989528880932e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes"], "Output": ">>> Performing hash slots allocation on 3 nodes...\nMaster[0] -> Slots 0 - 5460\nMaster[1] -> Slots 5461 - 10922\nMaster[2] -> Slots 10923 - 16383\nM: bff5f448ab2fd11183a3e946e0b5bfec898ba0ba 10.244.3.4:6379\n   slots:[0-5460] (5461 slots) master\nM: 9109160d7adf49e79def285144128c02c01c8b9b 10.244.2.6:6379\n   slots:[5461-10922] (5462 slots) master\nM: 0e853b12692d429aaa9b7d6ce93fc91cd4fa1791 10.244.1.4:6379\n   slots:[10923-16383] (5461 slots) master\n>>> Nodes configuration updated\n>>> Assign a different config epoch to each node\n>>> Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join\n..\n>>> Performing Cluster Check (using node 10.244.3.4:6379)\nM: bff5f448ab2fd11183a3e946e0b5bfec898ba0ba 10.244.3.4:6379\n   slots:[0-5460] (5461 slots) master\nM: 0e853b12692d429aaa9b7d6ce93fc91cd4fa1791 10.244.1.4:6379\n   slots:[10923-16383] (5461 slots) master\nM: 9109160d7adf49e79def285144128c02c01c8b9b 10.244.2.6:6379\n   slots:[5461-10922] (5462 slots) master\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n"}
1.6802989528881922e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989528882556e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989529021957e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() false, patchResult 
Patch: {"spec":{"template":{"spec":{"$setElementOrder/containers":[{"name":"test-cluster-leader"},{"name":"redis-exporter"}],"containers":[{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"$setElementOrder/volumeMounts":[{"mountPath":"/data"},{"mountPath":"/tls"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"test-cluster-leader","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"redis-exporter","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}}}} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzcVU1v4zYQ/S9zli3LrvOh2zZWiwCbrCGn28MiMEbUZEUsRXLJobqGof9eUP6IE6TZHHpoepI4fDOceW843AJa+Zmcl0ZDDmitT7sMEvgmdQ05rBiZHoJaEUMCLTHWyAj5FlBrw8jSaB+Xjmrpx8Z6dkQKKz+WMSC7QJC8uOsZtaCIIc8joYJnctAnoLAiNQRFa5/tjxRhTe4Qcu2Jg13zxsZAhxgJOKOiYQ/uE9DYPj/qMVTc9BaHZIawI2PJIZu4af7S5Ep6IEdakIf8yzPOdrW9VGHaZRUxRjqF0eyMUuQgj5wcCS6j39Ux8RfyhASCjNDzWXUxFdVkJCbT+eiX84vJ6LKe1aNsNqXsUtRnVF1Af98n4C2JnShWSYEe8lkCnhSJWFO+hRZZNB//dZ7j0eQ6Kej2Nb6ZWquQacjknbbUCctRW5Sa3K45SHfDdy/lsihX16u74vaqWBe3H379WCwggQ5VoEMxfXJEl8XierX+sFiUJ6AhrzxNlRGoGuM5P5udX566rYryc1Gubz4tihO/RwJOgHd/LP8Rd5+AbPFrtH0PuBlLk+4JTnc5dGfj6XgOe9gyKLU0SooN5HD9cGt46ciTjqNCyY40eb90phqEph8HttoWY+t/gQp9Awmkwbu0kjptCBU3oiHxbewbiJ38gFIFR3eNI98YVUM+T0BqyRLVghRuViSMrj3k2TwBS06a+omJZUsm8NE2/9kwcIS1/K9m7sib4IYxtAUlW8nDn7ABcsgmWTsM6da4qEg2vbiRMHh9D+TfAO0T6IwKLd2YoHnXzm38XSI3kEM63NRXCYzz5399B0b0wxrH5PJsPHnLTdif+tQZfqrl5O1avgjt+/uoZ7A1Mq3YIdPXDeTbo8ZXCmV7tx/Fe63f6TB+vSMfJzUKQd7fmHqoF0rC+k8nmT7FRO+fSXLKtGfjdj2R/f70ntTR+JtU5DeeqR1OY+QQ3frdY3xYAnYoFVaKyuO7PElOHulJ3/8dAAD//1BLBwjY2PSV8AIAAJAJAABQSwECFAAUAAgACAAAAAAA2Nj0lfACAACQCQAACAAAAAAAAAAAAAAAAAAAAAAAb3JpZ2luYWxQSwUGAAAAAAEAAQA2AAAAJgMAAAAA","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":1,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File"}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{}}]},"status":{"availableReplicas":0,"replicas":0}}
1.6802989532712915e+09	INFO	controller_redis	Changes in statefulset Detected, Updating...	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader", "patch": "{\"spec\":{\"template\":{\"spec\":{\"$setElementOrder/containers\":[{\"name\":\"test-cluster-leader\"},{\"name\":\"redis-exporter\"}],\"containers\":[{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"$setElementOrder/volumeMounts\":[{\"mountPath\":\"/data\"},{\"mountPath\":\"/tls\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"test-cluster-leader\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]},{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\",\"value\":\"true\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\",\"value\":\"/tls/tls.key\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"redis-exporter\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]}],\"volumes\":[{\"name\":\"tls-certs\",\"secret\":{\"items\":[{\"key\":\"ACTOKEY\"}]}}]}}}}"}

MATT IS HERE: updateStatefulSet &v1.StatefulSet{TypeMeta:v1.TypeMeta{Kind:"StatefulSet", APIVersion:"apps/v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-leader", GenerateName:"", Namespace:"redis-operator", SelfLink:"", UID:"", ResourceVersion:"1436", Generation:0, CreationTimestamp:time.Date(2023, time.March, 31, 21, 40, 2, 0, time.Local), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-leader", "redis_setup_type":"cluster", "role":"leader"}, Annotations:map[string]string{"banzaicloud.com/last-applied":"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", "redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference{v1.OwnerReference{APIVersion:"redis.redis.opstreelabs.in/v1beta1", Kind:"RedisCluster", Name:"test-cluster", UID:"73b82cb0-c025-4780-9d3d-132e19cd6eb8", Controller:(*bool)(0xc000f569a0), BlockOwnerDeletion:(*bool)(nil)}}, Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry{v1.ManagedFieldsEntry{Manager:"Go-http-client", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.March, 31, 21, 40, 2, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000a06960), Subresource:""}, v1.ManagedFieldsEntry{Manager:"kube-controller-manager", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.March, 31, 21, 40, 38, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000a06990), Subresource:"status"}}}, Spec:v1.StatefulSetSpec{Replicas:(*int32)(0xc000f5699c), Selector:(*v1.LabelSelector)(0xc0008bf3e0), Template:v1.PodTemplateSpec{ObjectMeta:v1.ObjectMeta{Name:"", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-leader", "redis_setup_type":"cluster", "role":"leader"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PodSpec{Volumes:[]v1.Volume{v1.Volume{Name:"tls-certs", VolumeSource:v1.VolumeSource{HostPath:(*v1.HostPathVolumeSource)(nil), EmptyDir:(*v1.EmptyDirVolumeSource)(nil), GCEPersistentDisk:(*v1.GCEPersistentDiskVolumeSource)(nil), AWSElasticBlockStore:(*v1.AWSElasticBlockStoreVolumeSource)(nil), GitRepo:(*v1.GitRepoVolumeSource)(nil), Secret:(*v1.SecretVolumeSource)(0xc0001780a0), NFS:(*v1.NFSVolumeSource)(nil), ISCSI:(*v1.ISCSIVolumeSource)(nil), Glusterfs:(*v1.GlusterfsVolumeSource)(nil), PersistentVolumeClaim:(*v1.PersistentVolumeClaimVolumeSource)(nil), RBD:(*v1.RBDVolumeSource)(nil), FlexVolume:(*v1.FlexVolumeSource)(nil), Cinder:(*v1.CinderVolumeSource)(nil), CephFS:(*v1.CephFSVolumeSource)(nil), Flocker:(*v1.FlockerVolumeSource)(nil), DownwardAPI:(*v1.DownwardAPIVolumeSource)(nil), FC:(*v1.FCVolumeSource)(nil), AzureFile:(*v1.AzureFileVolumeSource)(nil), ConfigMap:(*v1.ConfigMapVolumeSource)(nil), VsphereVolume:(*v1.VsphereVirtualDiskVolumeSource)(nil), Quobyte:(*v1.QuobyteVolumeSource)(nil), AzureDisk:(*v1.AzureDiskVolumeSource)(nil), PhotonPersistentDisk:(*v1.PhotonPersistentDiskVolumeSource)(nil), Projected:(*v1.ProjectedVolumeSource)(nil), PortworxVolume:(*v1.PortworxVolumeSource)(nil), ScaleIO:(*v1.ScaleIOVolumeSource)(nil), StorageOS:(*v1.StorageOSVolumeSource)(nil), CSI:(*v1.CSIVolumeSource)(nil), Ephemeral:(*v1.EphemeralVolumeSource)(nil)}}}, InitContainers:[]v1.Container(nil), Containers:[]v1.Container{v1.Container{Name:"test-cluster-leader", Image:"quay.io/opstree/redis:v6.2.5", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"test-cluster-leader", ReadOnly:false, MountPath:"/data", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}, v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(0xc00029d880), ReadinessProbe:(*v1.Probe)(0xc00029d840), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}, v1.Container{Name:"redis-exporter", Image:"quay.io/opstree/redis-exporter:1.0", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_SKIP_TLS_VERIFICATION", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CA_CERT_FILE", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(nil), ReadinessProbe:(*v1.Probe)(nil), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}}, EphemeralContainers:[]v1.EphemeralContainer(nil), RestartPolicy:"", TerminationGracePeriodSeconds:(*int64)(nil), ActiveDeadlineSeconds:(*int64)(nil), DNSPolicy:"", NodeSelector:map[string]string(nil), ServiceAccountName:"", DeprecatedServiceAccount:"", AutomountServiceAccountToken:(*bool)(nil), NodeName:"", HostNetwork:false, HostPID:false, HostIPC:false, ShareProcessNamespace:(*bool)(nil), SecurityContext:(*v1.PodSecurityContext)(nil), ImagePullSecrets:[]v1.LocalObjectReference(nil), Hostname:"", Subdomain:"", Affinity:(*v1.Affinity)(nil), SchedulerName:"", Tolerations:[]v1.Toleration(nil), HostAliases:[]v1.HostAlias(nil), PriorityClassName:"", Priority:(*int32)(nil), DNSConfig:(*v1.PodDNSConfig)(nil), ReadinessGates:[]v1.PodReadinessGate(nil), RuntimeClassName:(*string)(nil), EnableServiceLinks:(*bool)(nil), PreemptionPolicy:(*v1.PreemptionPolicy)(nil), Overhead:v1.ResourceList(nil), TopologySpreadConstraints:[]v1.TopologySpreadConstraint(nil), SetHostnameAsFQDN:(*bool)(nil), OS:(*v1.PodOS)(nil)}}, VolumeClaimTemplates:[]v1.PersistentVolumeClaim{v1.PersistentVolumeClaim{TypeMeta:v1.TypeMeta{Kind:"PersistentVolumeClaim", APIVersion:"v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-leader", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-leader", "redis_setup_type":"cluster", "role":"leader"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PersistentVolumeClaimSpec{AccessModes:[]v1.PersistentVolumeAccessMode{"ReadWriteOnce"}, Selector:(*v1.LabelSelector)(nil), Resources:v1.ResourceRequirements{Limits:v1.ResourceList(nil), Requests:v1.ResourceList{"storage":resource.Quantity{i:resource.int64Amount{value:1073741824, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"1Gi", Format:"BinarySI"}}}, VolumeName:"", StorageClassName:(*string)(nil), VolumeMode:(*v1.PersistentVolumeMode)(0xc000be7ef0), DataSource:(*v1.TypedLocalObjectReference)(nil), DataSourceRef:(*v1.TypedLocalObjectReference)(nil)}, Status:v1.PersistentVolumeClaimStatus{Phase:"Pending", AccessModes:[]v1.PersistentVolumeAccessMode(nil), Capacity:v1.ResourceList(nil), Conditions:[]v1.PersistentVolumeClaimCondition(nil), AllocatedResources:v1.ResourceList(nil), ResizeStatus:(*v1.PersistentVolumeClaimResizeStatus)(nil)}}}, ServiceName:"test-cluster-leader", PodManagementPolicy:"", UpdateStrategy:v1.StatefulSetUpdateStrategy{Type:"", RollingUpdate:(*v1.RollingUpdateStatefulSetStrategy)(nil)}, RevisionHistoryLimit:(*int32)(nil), MinReadySeconds:0, PersistentVolumeClaimRetentionPolicy:(*v1.StatefulSetPersistentVolumeClaimRetentionPolicy)(nil)}, Status:v1.StatefulSetStatus{ObservedGeneration:0, Replicas:0, ReadyReplicas:0, CurrentReplicas:0, UpdatedReplicas:0, CurrentRevision:"", UpdateRevision:"", CollisionCount:(*int32)(nil), Conditions:[]v1.StatefulSetCondition(nil), AvailableReplicas:0}}
1.6802989533708262e+09	INFO	controller_redis	Redis stateful successfully updated 	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.680298953375629e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989535724907e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989537701023e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989537733102e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989537773068e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802989537773395e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989537812572e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() false, patchResult 
Patch: {"spec":{"template":{"spec":{"$setElementOrder/containers":[{"name":"test-cluster-follower"},{"name":"redis-exporter"}],"containers":[{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"$setElementOrder/volumeMounts":[{"mountPath":"/data"},{"mountPath":"/tls"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"test-cluster-follower","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"$setElementOrder/env":[{"name":"PERSISTENCE_ENABLED"},{"name":"REDIS_ADDR"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE"},{"name":"REDIS_TLS_CA_KEY"},{"name":"REDIS_TLS_CERT"},{"name":"REDIS_TLS_CERT_KEY"},{"name":"SERVER_MODE"},{"name":"SETUP_MODE"},{"name":"TLS_MODE"}],"env":[{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"TLS_MODE","value":"true"}],"name":"redis-exporter","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}}}} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzcVd9v2zYQ/l/uWbYse84PvXWxNgRoUkPOuociME7UuSJKkSx5VGsY+t8Hyj/qBNmSlwHrnmwdvzvefd/dcQdo5UdyXhoNOaC1Pu0ySOCL1DXksGJk2gS1IoYEWmKskRHyHaDWhpGl0T5+OqqlHxvr2REprPxYxoDsAkHy4qln1IIihjyPhAqeyUGfgMKK1BAUrX12PtoYpcw3csega08c7Jq3NoY6RknAGRUNJ3ifgMb2+XXn4eKxtzikNIQeGUsO2cRD802TK2lDjrQgD/mnZ8ztK3ypzrTLKmKMpAqj2RmlyEEemTnRXEa/m1PyL2QKCQQZoZez6moqqslITKbz0S+XV5PRdT2rR9lsStm1qC+ouoL+sU/AWxJ7aaySAj3kswQ8KRKxpnwHLbJo3v8rbMfryXVS0P0/s87UWoVMQz4/cXud8R1VRqnJ7duEdDf8HkRdFuXqdvVQ3N8U6+L+3a/viwUk0KEKdCyoT07osljcrtbvFovyDDRklqepMgJVYzznF7PL63O3VVF+LMr13YdFceb3g4Qz4MMfy7/FPSYgW/wcbV8DbsfSpAeS030O3cV4Op7DAbYMSi2NkmILOdxu7g0vHXnScXUo2ZEm75fOVIPY9P3IVttiHIJPUKFvIIE0eJdWUqcNoeJGNCS+jH0Dsac3KFVw9NA48o1RNeTzBKSWLFEtSOF2RcLo2kOezROw5KSpn5hYtmQCn2zz1xeDI6zlfzV3R94EN6ykHSjZSh7+CRsgh2yStcPabo2LmmTTqzsJg9fXQP4N0D6BzqjQ0p0JmvcN3ca/S+QGckiHeX2FwriN/tdzMKLv1jgml2fjyVum4XDrU2d4Vc3J29V8Edr3j1HRYGtkWrFDps9byHcnlW8UyvbhsJIPav/ES/m1vvyxs1EI8v7O1EPVUBLWfzrJ9CGm+/hMmHO+PRu374zs96fzUkfjb1KR33qmdriNkUN06/cP9PETsEOpsFJUnt7qSXL2cE/6/q8AAAD//1BLBwhJAeJl8wIAAKoJAABQSwECFAAUAAgACAAAAAAASQHiZfMCAACqCQAACAAAAAAAAAAAAAAAAAAAAAAAb3JpZ2luYWxQSwUGAAAAAAEAAQA2AAAAKQMAAAAA","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":1,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File"}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.680298953876773e+09	INFO	controller_redis	Changes in statefulset Detected, Updating...	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower", "patch": "{\"spec\":{\"template\":{\"spec\":{\"$setElementOrder/containers\":[{\"name\":\"test-cluster-follower\"},{\"name\":\"redis-exporter\"}],\"containers\":[{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"$setElementOrder/volumeMounts\":[{\"mountPath\":\"/data\"},{\"mountPath\":\"/tls\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"test-cluster-follower\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]},{\"$setElementOrder/env\":[{\"name\":\"PERSISTENCE_ENABLED\"},{\"name\":\"REDIS_ADDR\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"},{\"name\":\"REDIS_TLS_CA_KEY\"},{\"name\":\"REDIS_TLS_CERT\"},{\"name\":\"REDIS_TLS_CERT_KEY\"},{\"name\":\"SERVER_MODE\"},{\"name\":\"SETUP_MODE\"},{\"name\":\"TLS_MODE\"}],\"env\":[{\"name\":\"REDIS_ADDR\",\"value\":\"rediss://localhost:6379\"},{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\",\"value\":\"true\"},{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\",\"value\":\"/tls/tls.key\"},{\"name\":\"REDIS_TLS_CA_KEY\",\"value\":\"/tls/ca.crt\"},{\"name\":\"REDIS_TLS_CERT\",\"value\":\"/tls/tls.crt\"},{\"name\":\"REDIS_TLS_CERT_KEY\",\"value\":\"/tls/tls.key\"},{\"name\":\"TLS_MODE\",\"value\":\"true\"}],\"name\":\"redis-exporter\",\"volumeMounts\":[{\"mountPath\":\"/tls\",\"name\":\"tls-certs\",\"readOnly\":true}]}],\"volumes\":[{\"name\":\"tls-certs\",\"secret\":{\"items\":[{\"key\":\"ACTOKEY\"}]}}]}}}}"}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"redis://localhost:6379"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{}}]},"status":{"availableReplicas":0,"replicas":0}}

MATT IS HERE: updateStatefulSet &v1.StatefulSet{TypeMeta:v1.TypeMeta{Kind:"StatefulSet", APIVersion:"apps/v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-follower", GenerateName:"", Namespace:"redis-operator", SelfLink:"", UID:"", ResourceVersion:"1445", Generation:0, CreationTimestamp:time.Date(2023, time.March, 31, 21, 40, 2, 0, time.Local), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-follower", "redis_setup_type":"cluster", "role":"follower"}, Annotations:map[string]string{"banzaicloud.com/last-applied":"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", "redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference{v1.OwnerReference{APIVersion:"redis.redis.opstreelabs.in/v1beta1", Kind:"RedisCluster", Name:"test-cluster", UID:"73b82cb0-c025-4780-9d3d-132e19cd6eb8", Controller:(*bool)(0xc000ba1a0c), BlockOwnerDeletion:(*bool)(nil)}}, Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry{v1.ManagedFieldsEntry{Manager:"Go-http-client", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.March, 31, 21, 40, 2, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000e05a10), Subresource:""}, v1.ManagedFieldsEntry{Manager:"kube-controller-manager", Operation:"Update", APIVersion:"apps/v1", Time:time.Date(2023, time.March, 31, 21, 40, 39, 0, time.Local), FieldsType:"FieldsV1", FieldsV1:(*v1.FieldsV1)(0xc000e05a40), Subresource:"status"}}}, Spec:v1.StatefulSetSpec{Replicas:(*int32)(0xc000ba1a08), Selector:(*v1.LabelSelector)(0xc000b8dfa0), Template:v1.PodTemplateSpec{ObjectMeta:v1.ObjectMeta{Name:"", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-follower", "redis_setup_type":"cluster", "role":"follower"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PodSpec{Volumes:[]v1.Volume{v1.Volume{Name:"tls-certs", VolumeSource:v1.VolumeSource{HostPath:(*v1.HostPathVolumeSource)(nil), EmptyDir:(*v1.EmptyDirVolumeSource)(nil), GCEPersistentDisk:(*v1.GCEPersistentDiskVolumeSource)(nil), AWSElasticBlockStore:(*v1.AWSElasticBlockStoreVolumeSource)(nil), GitRepo:(*v1.GitRepoVolumeSource)(nil), Secret:(*v1.SecretVolumeSource)(0xc0001780a0), NFS:(*v1.NFSVolumeSource)(nil), ISCSI:(*v1.ISCSIVolumeSource)(nil), Glusterfs:(*v1.GlusterfsVolumeSource)(nil), PersistentVolumeClaim:(*v1.PersistentVolumeClaimVolumeSource)(nil), RBD:(*v1.RBDVolumeSource)(nil), FlexVolume:(*v1.FlexVolumeSource)(nil), Cinder:(*v1.CinderVolumeSource)(nil), CephFS:(*v1.CephFSVolumeSource)(nil), Flocker:(*v1.FlockerVolumeSource)(nil), DownwardAPI:(*v1.DownwardAPIVolumeSource)(nil), FC:(*v1.FCVolumeSource)(nil), AzureFile:(*v1.AzureFileVolumeSource)(nil), ConfigMap:(*v1.ConfigMapVolumeSource)(nil), VsphereVolume:(*v1.VsphereVirtualDiskVolumeSource)(nil), Quobyte:(*v1.QuobyteVolumeSource)(nil), AzureDisk:(*v1.AzureDiskVolumeSource)(nil), PhotonPersistentDisk:(*v1.PhotonPersistentDiskVolumeSource)(nil), Projected:(*v1.ProjectedVolumeSource)(nil), PortworxVolume:(*v1.PortworxVolumeSource)(nil), ScaleIO:(*v1.ScaleIOVolumeSource)(nil), StorageOS:(*v1.StorageOSVolumeSource)(nil), CSI:(*v1.CSIVolumeSource)(nil), Ephemeral:(*v1.EphemeralVolumeSource)(nil)}}}, InitContainers:[]v1.Container(nil), Containers:[]v1.Container{v1.Container{Name:"test-cluster-follower", Image:"quay.io/opstree/redis:v6.2.5", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:101, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"101m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"test-cluster-follower", ReadOnly:false, MountPath:"/data", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}, v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(0xc0007b4a40), ReadinessProbe:(*v1.Probe)(0xc0007b4a00), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}, v1.Container{Name:"redis-exporter", Image:"quay.io/opstree/redis-exporter:1.0", Command:[]string(nil), Args:[]string(nil), WorkingDir:"", Ports:[]v1.ContainerPort(nil), EnvFrom:[]v1.EnvFromSource(nil), Env:[]v1.EnvVar{v1.EnvVar{Name:"PERSISTENCE_ENABLED", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_ADDR", Value:"rediss://localhost:6379", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_SKIP_TLS_VERIFICATION", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CA_CERT_FILE", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CA_KEY", Value:"/tls/ca.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT", Value:"/tls/tls.crt", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"REDIS_TLS_CERT_KEY", Value:"/tls/tls.key", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SERVER_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"SETUP_MODE", Value:"cluster", ValueFrom:(*v1.EnvVarSource)(nil)}, v1.EnvVar{Name:"TLS_MODE", Value:"true", ValueFrom:(*v1.EnvVarSource)(nil)}}, Resources:v1.ResourceRequirements{Limits:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}, Requests:v1.ResourceList{"cpu":resource.Quantity{i:resource.int64Amount{value:100, scale:-3}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"100m", Format:"DecimalSI"}, "memory":resource.Quantity{i:resource.int64Amount{value:134217728, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"", Format:"BinarySI"}}}, VolumeMounts:[]v1.VolumeMount{v1.VolumeMount{Name:"tls-certs", ReadOnly:true, MountPath:"/tls", SubPath:"", MountPropagation:(*v1.MountPropagationMode)(nil), SubPathExpr:""}}, VolumeDevices:[]v1.VolumeDevice(nil), LivenessProbe:(*v1.Probe)(nil), ReadinessProbe:(*v1.Probe)(nil), StartupProbe:(*v1.Probe)(nil), Lifecycle:(*v1.Lifecycle)(nil), TerminationMessagePath:"", TerminationMessagePolicy:"", ImagePullPolicy:"IfNotPresent", SecurityContext:(*v1.SecurityContext)(nil), Stdin:false, StdinOnce:false, TTY:false}}, EphemeralContainers:[]v1.EphemeralContainer(nil), RestartPolicy:"", TerminationGracePeriodSeconds:(*int64)(nil), ActiveDeadlineSeconds:(*int64)(nil), DNSPolicy:"", NodeSelector:map[string]string(nil), ServiceAccountName:"", DeprecatedServiceAccount:"", AutomountServiceAccountToken:(*bool)(nil), NodeName:"", HostNetwork:false, HostPID:false, HostIPC:false, ShareProcessNamespace:(*bool)(nil), SecurityContext:(*v1.PodSecurityContext)(nil), ImagePullSecrets:[]v1.LocalObjectReference(nil), Hostname:"", Subdomain:"", Affinity:(*v1.Affinity)(nil), SchedulerName:"", Tolerations:[]v1.Toleration(nil), HostAliases:[]v1.HostAlias(nil), PriorityClassName:"", Priority:(*int32)(nil), DNSConfig:(*v1.PodDNSConfig)(nil), ReadinessGates:[]v1.PodReadinessGate(nil), RuntimeClassName:(*string)(nil), EnableServiceLinks:(*bool)(nil), PreemptionPolicy:(*v1.PreemptionPolicy)(nil), Overhead:v1.ResourceList(nil), TopologySpreadConstraints:[]v1.TopologySpreadConstraint(nil), SetHostnameAsFQDN:(*bool)(nil), OS:(*v1.PodOS)(nil)}}, VolumeClaimTemplates:[]v1.PersistentVolumeClaim{v1.PersistentVolumeClaim{TypeMeta:v1.TypeMeta{Kind:"PersistentVolumeClaim", APIVersion:"v1"}, ObjectMeta:v1.ObjectMeta{Name:"test-cluster-follower", GenerateName:"", Namespace:"", SelfLink:"", UID:"", ResourceVersion:"", Generation:0, CreationTimestamp:time.Date(1, time.January, 1, 0, 0, 0, 0, time.UTC), DeletionTimestamp:<nil>, DeletionGracePeriodSeconds:(*int64)(nil), Labels:map[string]string{"app":"test-cluster-follower", "redis_setup_type":"cluster", "role":"follower"}, Annotations:map[string]string{"redis.opstreelabs.in":"true", "redis.opstreelabs.instance":"test-cluster"}, OwnerReferences:[]v1.OwnerReference(nil), Finalizers:[]string(nil), ClusterName:"", ManagedFields:[]v1.ManagedFieldsEntry(nil)}, Spec:v1.PersistentVolumeClaimSpec{AccessModes:[]v1.PersistentVolumeAccessMode{"ReadWriteOnce"}, Selector:(*v1.LabelSelector)(nil), Resources:v1.ResourceRequirements{Limits:v1.ResourceList(nil), Requests:v1.ResourceList{"storage":resource.Quantity{i:resource.int64Amount{value:1073741824, scale:0}, d:resource.infDecAmount{Dec:(*inf.Dec)(nil)}, s:"1Gi", Format:"BinarySI"}}}, VolumeName:"", StorageClassName:(*string)(nil), VolumeMode:(*v1.PersistentVolumeMode)(0xc000d67730), DataSource:(*v1.TypedLocalObjectReference)(nil), DataSourceRef:(*v1.TypedLocalObjectReference)(nil)}, Status:v1.PersistentVolumeClaimStatus{Phase:"Pending", AccessModes:[]v1.PersistentVolumeAccessMode(nil), Capacity:v1.ResourceList(nil), Conditions:[]v1.PersistentVolumeClaimCondition(nil), AllocatedResources:v1.ResourceList(nil), ResizeStatus:(*v1.PersistentVolumeClaimResizeStatus)(nil)}}}, ServiceName:"test-cluster-follower", PodManagementPolicy:"", UpdateStrategy:v1.StatefulSetUpdateStrategy{Type:"", RollingUpdate:(*v1.RollingUpdateStatefulSetStrategy)(nil)}, RevisionHistoryLimit:(*int32)(nil), MinReadySeconds:0, PersistentVolumeClaimRetentionPolicy:(*v1.StatefulSetPersistentVolumeClaimRetentionPolicy)(nil)}, Status:v1.StatefulSetStatus{ObservedGeneration:0, Replicas:0, ReadyReplicas:0, CurrentReplicas:0, UpdatedReplicas:0, CurrentRevision:"", UpdateRevision:"", CollisionCount:(*int32)(nil), Conditions:[]v1.StatefulSetCondition(nil), AvailableReplicas:0}}
1.6802989539791048e+09	INFO	controller_redis	Redis stateful successfully updated 	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.680298953982659e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989541702538e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989542699583e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680298954272077e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680298954276107e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989542761424e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989542807236e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802989542856057e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802989542856376e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.6802989543705566e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989543712766e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989543713427e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989543713655e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989593724742e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989593725672e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989593726e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6802989593726256e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0"}
1.6802989593847225e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989593856003e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989593856754e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989593857303e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989643862865e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680298964386386e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989643864057e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6802989643864222e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0", "Type": "leader"}
1.6802989643864307e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 0, "Instance.Size": 3}
1.6802989643933883e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.680298964397105e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.6802989644006393e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "10.244.1.4"}
1.680298964400667e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"]}
1.6802989644040778e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.680298964770945e+09	ERROR	controller_redis	Could not execute command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": "", "Error": "Unrecognized option or bad number of args for: '--tls'\n", "error": "command terminated with exit code 1"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:71
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.68029896477121e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": ""}
1.6802989647712328e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989647713494e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989648701227e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1558","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.680298964973564e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1558"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680298965070134e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989650736053e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989651705444e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989654738207e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989655779285e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802989655779884e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680298965583308e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1578","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1578"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.680298965675164e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989656808138e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680298965871449e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989658783224e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989658815932e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989658854558e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989658854995e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.680298965971218e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802989660708752e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802989660709586e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.6802989660774648e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989660781524e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680298966078236e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989660782843e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989710790281e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989710791092e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989710791242e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6802989710791385e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0"}
1.680298971087606e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989710882947e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989710883608e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680298971088399e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989760890107e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989760890737e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680298976089091e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6802989760891054e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0", "Type": "leader"}
1.680298976089111e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 0, "Instance.Size": 3}
1.6802989760929205e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989760973823e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.6802989761022713e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "10.244.1.4"}
1.68029897610232e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"]}
1.6802989761744838e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.680298976530195e+09	ERROR	controller_redis	Could not execute command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": "", "Error": "Unrecognized option or bad number of args for: '--tls'\n", "error": "command terminated with exit code 1"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:71
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
MATT IS HERE: Reconcile
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
MATT IS HERE: CreateRedisLeader
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
MATT IS HERE: CreateRedisClusterSetup
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
MATT IS HERE: CreateOrUpdateStateFul
1.6802989765303342e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "10.244.1.4:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": ""}
1.6802989765303416e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989765303903e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.680298976571049e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1558","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1558"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989766747983e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802989766785948e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989766816635e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989766855466e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989767717965e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.680298976776327e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802989767763646e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680298976781529e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802989771776228e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1578","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1578"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989772700033e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989772718236e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989772748573e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989772775164e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989772799137e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.680298977279936e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989773718922e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802989773784964e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802989773785243e+09	INFO	controllers.RedisCluster	Creating redis cluster by executing cluster creation commands	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Ready": "3", "Followers.Ready": "3"}
1.680298977382622e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989774703314e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989774704387e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680298977470482e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989824711673e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989824713087e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:120
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989824713306e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.6802989824713464e+09	INFO	controller_redis	Total number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0"}
1.6802989824773378e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989824780436e+09	ERROR	controller_redis	Failed in getting TLS secret for redis	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "resource name may not be empty"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.680298982478101e+09	ERROR	controller_redis	Couldn't load TLS client key pair	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "error": "tls: failed to find any PEM data in certificate input"}
redis-operator/k8sutils.configureRedisClient
	/workspace/k8sutils/redis.go:261
redis-operator/k8sutils.checkRedisCluster
	/workspace/k8sutils/redis.go:136
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989824781253e+09	INFO	controller_redis	Failed to load CA Certificates from Secret	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
1.6802989874791787e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989874792943e+09	ERROR	controller_redis	Redis command failed with this error	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "error": "context deadline exceeded"}
redis-operator/k8sutils.CheckRedisNodeCount
	/workspace/k8sutils/redis.go:196
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:121
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989874793258e+09	INFO	controller_redis	Redis cluster nodes are listed	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Output": ""}
1.680298987479343e+09	INFO	controller_redis	Number of redis nodes are	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Nodes": "0", "Type": "leader"}
1.6802989874793532e+09	INFO	controllers.RedisCluster	Not all leader are part of the cluster...	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Leaders.Count": 0, "Instance.Size": 3}
1.680298987489408e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-0", "ip": "10.244.3.4"}
1.6802989874940567e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-1", "ip": "10.244.2.6"}
1.680298987497404e+09	ERROR	controller_redis	Error in getting redis pod IP	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "error": "pods \"test-cluster-leader-2\" not found"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:57
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989874974806e+09	INFO	controller_redis	Redis is IPv6	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "", "ipv6": "<nil>"}
1.6802989874974985e+09	INFO	controller_redis	Successfully got the ip for redis	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster-leader-2", "ip": "[]"}
1.680298987497516e+09	INFO	controller_redis	Redis cluster creation command is	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "[]:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"]}
1.6802989875030189e+09	INFO	controller_redis	Pod Counted successfully	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Count": 0, "Container Name": "test-cluster-leader"}
1.6802989876772559e+09	ERROR	controller_redis	Could not execute command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "[]:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": "", "Error": "Unrecognized option or bad number of args for: '--tls'\n", "error": "command terminated with exit code 1"}
redis-operator/k8sutils.ExecuteRedisClusterCommand
	/workspace/k8sutils/redis.go:71
redis-operator/controllers.(*RedisClusterReconciler).Reconcile
	/workspace/controllers/rediscluster_controller.go:124
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:114
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:311
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:266
sigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2
	/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.11.0/pkg/internal/controller/controller.go:227
1.6802989876773987e+09	INFO	controller_redis	Successfully executed the command	{"Request.RedisManager.Namespace": "redis-operator", "Request.RedisManager.Name": "test-cluster", "Command": ["redis-cli", "--cluster", "create", "10.244.3.4:6379", "10.244.2.6:6379", "[]:6379", "--cluster-yes", "--tls", "--cacert", "/tls/ca.crt", "-h", "test-cluster-leader-0"], "Output": ""}
1.6802989876774216e+09	INFO	controllers.RedisCluster	Will reconcile redis cluster operator in again 10 seconds	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
1.6802989876775057e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989876843624e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802989880754833e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"UEsDBBQACAAIAAAAAAAAAAAAAAAAAAAAAAAIAAAAb3JpZ2luYWzsWFtv2zgW/i/nWfK1SVO9ZR01azQXw/ZkdyYJDJo6jolQpIakvPUa/u8LUlfLduPpFu0UKJCHmDwX8jsXfkcbIAl7QKWZFBAASRLdXnXBg1cmIghgYojBRconaMCDGA2JiCEQbIAIIQ0xTAptfyqMmG7JRBuFyMlct5g1aFSK4B3c1YYIilYGtfEpT7VBBVsPqEJnd8pi1IbECQTQ6/T6fqfv97vTXjd41wk6vT/AA07myJ1/kiQNUz5HEqEqvM80mjSZmXVifRbuPFCS24VceOtBTAR5wegjQx5pCB6PQrRwEtPMYCb+UK0/dO2xFkEds0XQQK0FwWbrwSKYE/FfwiiXadSiMm5zoo1PkoQzjAqZwxAf3ysA3mydSIVV6dWBVjOwg1G+7uDJTcj/CFRjXKBCQbFu6zXYPEHKoicInuB9f37Ro/OOTzu9M//d+4uO/yHqR36338PuBxqd4/ziCbbOrLOrE6QZPomMbh3+MQozkpzRdXXChDNKdPV7xWxM/sm0kWp9w2Jmij2NHKmRqvqtVoziHYnLixmME04M/pUo/dgINKCiUhjCBCpn0QVAkBhdBJwtHz8nUhlUGdaVUxSrZuhKzVE4ngwn0/BuEM7Cu8t/3IRXTXVRQ3FFeFpccNfQOLwaTmaXV1fjr9OfhOOHcDy7vb8Kv9bA9LfRX9B3P1lMXso992OUcr6biHV1hVqmarcWFgG3ubi7RJO0+DfGWKp1mRUK/0xRnySeJ66KmXDZeYta2yMSs6zSem+3PPweRAfa5a9cOUX/5FzhbIUCtR4pOcddYD9nhVyFXMYxEVGZFwvCeKpwulSol5KXzwATzDDCr5CT9QSpFFHZEhNUTEaNRZ1Silrv2TEsRpmamvSB7CYR+7mO/1MVpEsqydMYb2UqzN6DGttVa8wlads+UM38LEWgkbDb/HSR0M13VBuiGo+rpkuMUo6q/kRqpKliZj2QwuBnc+BG14pQHDXDljlOk4gYnBhFDL6sszdLSc6ZePnNbe3cIyHKMOMoVh6G4g2soTTghMXT/OEuXWWETUEA19JfGpP4lDMUlrDKBBXJrELu1AObOcco5db7P+meNsSkOqcRK8I4mXMcN6gLtTBYBwMbvXI1VQqF2RMuljO6UyzLuSU1GF2jKO9YVe26aaXJnrLoNI1mq1FdeRfh13SOvmUeNpKo/GLnCNQ6nRcFCQHk2ByPQP/iD9g+e5Dl8BE2bzd1QpzFjOdkrqU7RZOhNul7RtMOkbX2qjtHQ2xIqwtCYCeYchwaW71BOTscOCd4lgZDcBIJdpctAKrO2H3XP7eTSMH1qtj1PahRW4iJocubbz4DWdd1wnzEZJ1Bf5/J8NuPezWU63z6cQOO+Dxuihgf4DrgQc4IssvY3pFLV4SmJuTOpYN2m0tK+FJqE5z333/Y15veTGaDy9mn8Peadttw3aakRZU5ohGOp015w/WXFQ45sUqvuK4r1QhWTbqKTE2wIFJflrP+G1IZhs8e5LwK/kzJusVkO0+OtsMvWJ23eq0zyMXqjAuGiztpRgp11vz3uFfBWUqq8ghzopfgQTvVqj1nor1Ews2SLpG+tvQSnm1X3CMyZx4cZDHdMw8aHMYuNZnK2faNDrdPu/5GJ98hWBWvcvwIup1u7L4TZQwJur2LWwZOq+JUXxTderDLiB43UOM4GQk63Hr98htOQ8VwXdPg2qeojM6Bvhd8nXX57bPV/IF1H/57dD+ehuPZ5NNw5Er0IRwPPw4Hl9Ph/d2bbkv1vH+4+v44vAlP7SK7Bm6G4d30uJGjreWQlU/h70eNNFrNrxb4Vgssv+sE3VbnlEaYO9xVhjdLuXN6KR8UfbOUT6/L58KUrtdmXUUjVWipNDCDcSZmIxjA5WB6b0O8fd7aPw/2BpPyoM35okke61/GR3ZVGxTmodL9bt/Ivz0TeqOlljSJuHH8VkYOIBgjif6lmMF7e9DnRlLVc0UbqbKs7l7vZkeEbqLiqNfaYOy8lWNUsiQaHd4iYuIFbBDr+weGrI5Xo8yd7fZ/AQAA//9QSwcILFTNePoFAADlGAAAUEsBAhQAFAAIAAgAAAAAACxUzXj6BQAA5RgAAAgAAAAAAAAAAAAAAAAAAAAAAG9yaWdpbmFsUEsFBgAAAAABAAEANgAAADAGAAAAAA==","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989880792973e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989880821025e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989881741145e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989881773796e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989881816173e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802989881816633e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989882709794e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802989887741103e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989887793276e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989887823093e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989888748713e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989888772726e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989888806715e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.680298988880717e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989889711485e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.680298988978437e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802989889785147e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6802989976783054e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802989976852803e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6802989977743413e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989977804346e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.680298997870912e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802989979704394e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989981737144e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802989981806111e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802989981806548e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.680298998269944e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802989984752991e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802989984816082e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680298998574609e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802989988772388e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680298998970463e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802989989756384e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989989756832e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802989989812708e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802989990714192e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.680298999071477e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6802991190724974e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802991190807552e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802991196738381e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680299119682022e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802991196831927e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802991196862526e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802991196883836e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802991196905706e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802991196906087e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802991197765152e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802991200742307e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802991201732137e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802991201743796e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.680299120177601e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802991201810565e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802991201843953e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802991201844282e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802991202705956e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802991202757373e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802991202757888e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6802992402765307e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802992402808201e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6802992406771462e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802992406833735e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802992406863966e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802992407745395e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802992407774987e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802992408700063e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802992408700624e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802992408758638e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.680299241472336e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680299241481747e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802992415722046e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802992415774055e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802992415801e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802992415835946e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802992415836453e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802992416712778e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802992416785507e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802992416785965e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.6802993616791074e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802993616902826e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.6802993620699441e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802993620774603e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802993620813437e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802993620846694e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802993621711905e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802993621761122e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.68029936217616e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802993621812136e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
1.680299362472603e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.6802993624791338e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802993624822404e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802993625742533e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802993626728568e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680299362676908e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802993626769881e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802993627703335e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802993628705742e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.6802993628706422e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}
1.680299482871165e+09	INFO	controllers.RedisCluster	Reconciling opstree redis Cluster controller	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster"}
MATT IS HERE: Reconcile
MATT IS HERE: CreateRedisLeader
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802994828790667e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654","uid":"6923b9e0-8bfe-4e6f-a95d-72c08113771b"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.680299483273839e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1654"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-leader\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:38Z"}],"name":"test-cluster-leader","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1436"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"serviceName":"test-cluster-leader","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-leader","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-leader"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-leader","redis_setup_type":"cluster","role":"leader"},"name":"test-cluster-leader"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680299483370162e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802994833733735e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader-headless"}
1.6802994833785121e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802994834731274e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-leader"}
1.6802994834782903e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
1.6802994834783466e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-leader"}
MATT IS HERE: CreateRedisFollower
MATT IS HERE: CreateRedisClusterSetup
MATT IS HERE: CreateOrUpdateStateFul
1.6802994834835415e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
MATT IS HERE: patchStatefulSet
MATT IS HERE: patchResult.IsEmpty() true, patchResult 
Patch: {} 
Current: {"metadata":{"annotations":{"banzaicloud.com/last-applied":"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","redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","generation":2,"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681","uid":"9432be7b-5966-4dfb-ae6a-9745bde6e148"},"spec":{"podManagementPolicy":"OrderedReady","replicas":3,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"successThreshold":1,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"dnsPolicy":"ClusterFirst","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"terminationGracePeriodSeconds":30,"volumes":[{"name":"tls-certs","secret":{"defaultMode":420,"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{"rollingUpdate":{"partition":0},"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
1.6802994839717753e+09	INFO	controller_redis	Reconciliation Complete, no Changes required.	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
Modified: {"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_SKIP_TLS_VERIFICATION\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CA_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CA_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_TLS_CERT_KEY\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"TLS_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tls\"}":{".":{},"f:mountPath":{},"f:name":{},"f:readOnly":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{},"f:volumes":{".":{},"k:{\"name\":\"tls-certs\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:items":{}}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:42:33Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:42:33Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1681"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]}}
Original: {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"creationTimestamp":"2023-03-31T21:40:02Z","labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:banzaicloud.com/last-applied":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"73b82cb0-c025-4780-9d3d-132e19cd6eb8\"}":{}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:redis.opstreelabs.in":{},"f:redis.opstreelabs.instance":{}},"f:labels":{".":{},"f:app":{},"f:redis_setup_type":{},"f:role":{}}},"f:spec":{"f:containers":{"k:{\"name\":\"redis-exporter\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{}},"k:{\"name\":\"test-cluster-follower\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"PERSISTENCE_ENABLED\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"REDIS_ADDR\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SERVER_MODE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"SETUP_MODE\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:livenessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:name":{},"f:readinessProbe":{".":{},"f:exec":{".":{},"f:command":{}},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/data\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{},"f:terminationGracePeriodSeconds":{}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}},"manager":"Go-http-client","operation":"Update","time":"2023-03-31T21:40:02Z"},{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:availableReplicas":{},"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}},"manager":"kube-controller-manager","operation":"Update","subresource":"status","time":"2023-03-31T21:40:39Z"}],"name":"test-cluster-follower","namespace":"redis-operator","ownerReferences":[{"apiVersion":"redis.redis.opstreelabs.in/v1beta1","controller":true,"kind":"RedisCluster","name":"test-cluster","uid":"73b82cb0-c025-4780-9d3d-132e19cd6eb8"}],"resourceVersion":"1445"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"serviceName":"test-cluster-follower","template":{"metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"}},"spec":{"containers":[{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis:v6.2.5","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"name":"test-cluster-follower","readinessProbe":{"exec":{"command":["bash","/usr/bin/healthcheck.sh"]},"failureThreshold":5,"initialDelaySeconds":15,"periodSeconds":15,"timeoutSeconds":5},"resources":{"limits":{"cpu":"101m","memory":"128Mi"},"requests":{"cpu":"101m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/data","name":"test-cluster-follower"},{"mountPath":"/tls","name":"tls-certs","readOnly":true}]},{"env":[{"name":"PERSISTENCE_ENABLED","value":"true"},{"name":"REDIS_ADDR","value":"rediss://localhost:6379"},{"name":"REDIS_EXPORTER_SKIP_TLS_VERIFICATION","value":"true"},{"name":"REDIS_EXPORTER_TLS_CA_CERT_FILE","value":"/tls/ca.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_CERT_FILE","value":"/tls/tls.crt"},{"name":"REDIS_EXPORTER_TLS_CLIENT_KEY_FILE","value":"/tls/tls.key"},{"name":"REDIS_TLS_CA_KEY","value":"/tls/ca.crt"},{"name":"REDIS_TLS_CERT","value":"/tls/tls.crt"},{"name":"REDIS_TLS_CERT_KEY","value":"/tls/tls.key"},{"name":"SERVER_MODE","value":"cluster"},{"name":"SETUP_MODE","value":"cluster"},{"name":"TLS_MODE","value":"true"}],"image":"quay.io/opstree/redis-exporter:1.0","imagePullPolicy":"IfNotPresent","name":"redis-exporter","resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/tls","name":"tls-certs","readOnly":true}]}],"volumes":[{"name":"tls-certs","secret":{"items":[{"key":"ACTOKEY"}]}}]}},"updateStrategy":{},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"annotations":{"redis.opstreelabs.in":"true","redis.opstreelabs.instance":"test-cluster"},"labels":{"app":"test-cluster-follower","redis_setup_type":"cluster","role":"follower"},"name":"test-cluster-follower"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}]},"status":{"availableReplicas":0,"replicas":0}}

1.680299483977904e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802994839816089e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower-headless"}
1.6802994840701015e+09	INFO	controller_redis	Redis service get action is successful	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.680299484072738e+09	INFO	controller_redis	Redis service is already in-sync	{"Request.Service.Namespace": "redis-operator", "Request.Service.Name": "test-cluster-follower"}
1.6802994840767405e+09	INFO	controller_redis	Redis PodDisruptionBudget get action failed	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802994840767796e+09	INFO	controller_redis	Reconciliation Successful, no PodDisruptionBudget Found.	{"Request.PodDisruptionBudget.Namespace": "redis-operator", "Request.PodDisruptionBudget.Name": "test-cluster-follower"}
1.6802994841697302e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-leader"}
1.6802994841748853e+09	INFO	controller_redis	Redis statefulset get action was successful	{"Request.StatefulSet.Namespace": "redis-operator", "Request.StatefulSet.Name": "test-cluster-follower"}
1.680299484174931e+09	INFO	controllers.RedisCluster	Redis leader and follower nodes are not ready yet	{"Request.Namespace": "redis-operator", "Request.Name": "test-cluster", "Ready.Replicas": "2", "Expected.Replicas": 3}

